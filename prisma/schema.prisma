// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

// Looking for ways to speed up your queries, or scale easily with your serverless or edge functions?
// Try Prisma Accelerate: https://pris.ly/cli/accelerate-init

generator client {
  provider = "prisma-client"
  output   = "../app/generated/prisma"
}

datasource db {
  provider = "postgresql"
}

/// 用户角色：user-普通用户，admin-管理员
enum UserRole {
  USER // 普通用户
  ADMIN // 管理员
}

/// 用户表
model users {
  /// 用户ID，主键，自增
  id              Int       @id @default(autoincrement())
  /// 用户姓名
  name            String    @db.VarChar(100)
  /// 用户名，可选
  username        String?   @unique @db.VarChar(100)
  /// 电子邮箱，可选
  email           String?   @unique @db.VarChar(100)
  /// 手机号，唯一标识
  phone           String    @unique @db.VarChar(11)
  /// 密码，加密存储
  password        String?   @db.VarChar(100)
  /// 用户角色：user-普通用户，admin-管理员
  role            UserRole  @default(USER)
  /// 用户状态：1-启用，0-禁用
  status          Int       @default(1)
  /// 所属公司/律所，可选
  company         String?   @db.VarChar(100)
  /// 个人简介，可选
  profile         String?
  /// 邀请码，唯一
  inviteCode      String    @unique @map("invite_code") @db.VarChar(10)
  /// 邀请人用户ID，外键关联用户表
  invitedBy       Int?      @map("invited_by")
  /// 微信小程序openid
  openid          String?   @map("openid") @db.VarChar(100)
  /// 微信小程序unionid
  unionid         String?   @map("unionid") @db.VarChar(100)
  /// 用户注册渠道
  registerChannel String?   @map("register_channel") @db.VarChar(100)
  /// 创建时间
  createdAt       DateTime? @default(now()) @map("created_at") @db.Timestamptz(6)
  /// 最后更新时间
  updatedAt       DateTime? @default(now()) @map("updated_at") @db.Timestamptz(6)
  /// 删除时间
  deletedAt       DateTime? @map("deleted_at") @db.Timestamptz(6)

  @@index([id], map: "idx_users_id")
  @@index([status], map: "idx_users_status")
  @@index([deletedAt], map: "idx_users_deleted_at")
  @@index([role], map: "idx_users_role")
  @@map("users")
}
